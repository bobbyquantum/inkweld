name = "inkweld-backend"
main = "src/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# Account ID (set via environment variable or wrangler login)
# account_id = ""

# Workers configuration
workers_dev = true
route = ""
zone_id = ""

[build]
command = ""

# Environment variables (sensitive values should be set via wrangler secret)
[vars]
NODE_ENV = "production"
PORT = "8333"
ALLOWED_ORIGINS = "http://localhost:4200,https://inkweld.app"
USER_APPROVAL_REQUIRED = "false"
GITHUB_ENABLED = "false"
RECAPTCHA_ENABLED = "false"

# Database binding (Cloudflare D1)
# Uncomment and configure when ready to use D1
# [[d1_databases]]
# binding = "DB"
# database_name = "inkweld-db"
# database_id = "your-d1-database-id"

# R2 bucket for file storage (covers, avatars, etc.)
# Uncomment and configure when ready to use R2
# [[r2_buckets]]
# binding = "STORAGE"
# bucket_name = "inkweld-storage"

# KV namespace for session storage (alternative to D1)
# Uncomment and configure for session management
# [[kv_namespaces]]
# binding = "SESSIONS"
# id = "your-kv-namespace-id"

# Durable Objects for Yjs document collaboration
# Uncomment and configure when implementing Yjs collaboration
# [[durable_objects.bindings]]
# name = "YJS_DOCUMENTS"
# class_name = "YjsDocument"
# script_name = "inkweld-backend"

# [[migrations]]
# tag = "v1"
# new_classes = ["YjsDocument"]

# Secrets (set via: wrangler secret put SECRET_NAME)
# - SESSION_SECRET
# - DB_PATH (if using local SQLite in dev)
# - GITHUB_CLIENT_ID (if GitHub OAuth enabled)
# - GITHUB_CLIENT_SECRET (if GitHub OAuth enabled)
# - RECAPTCHA_SITE_KEY (if reCAPTCHA enabled)
# - RECAPTCHA_SECRET_KEY (if reCAPTCHA enabled)

# Development configuration
[env.dev]
name = "inkweld-backend-dev"
vars = { NODE_ENV = "development" }

# Production configuration
[env.production]
name = "inkweld-backend-prod"
vars = { NODE_ENV = "production", USER_APPROVAL_REQUIRED = "true" }
