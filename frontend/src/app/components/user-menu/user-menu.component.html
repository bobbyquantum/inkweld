<div class="menu-container">
  @if (!miniMode) {
    <button mat-fab extended [matMenuTriggerFor]="menu" class="user-menu">
      <div class="menu-content">
        <app-user-avatar [username]="user?.username || ''" size="medium" />
        <div class="user-name">
          {{ userService.currentUser()!.username }}
        </div>
      </div>
    </button>
  } @else {
    <button
      mat-icon-button
      [matMenuTriggerFor]="menu"
      class="user-menu mini-mode">
      <app-user-avatar
        [username]="userService.currentUser()!.username"
        size="medium" />
    </button>
  }

  <mat-menu
    #menu="matMenu"
    yPosition="above"
    class="menu-popover"
    backdropClass="menu-popover">
    <button
      class="user-info"
      mat-menu-item
      [routerLink]="['/', userService.currentUser()!.username]">
      <span
        ><app-user-avatar
          [username]="userService.currentUser()!.username"
          size="medium" />
        {{ userService.currentUser().username }}</span
      >
    </button>
    <mat-divider></mat-divider>
    <button mat-menu-item (click)="onSettings()">
      <mat-icon>settings</mat-icon>
      <span>Settings</span>
    </button>
    <button mat-menu-item (click)="onLogout()">
      <mat-icon>exit_to_app</mat-icon>
      <span>Log out</span>
    </button>
  </mat-menu>
</div>
