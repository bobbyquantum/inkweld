<div class="login-dialog" data-testid="login-dialog">
  <div class="dialog-header">
    <img src="logo.png" alt="Inkweld Logo" class="logo-image" />
    <h2 mat-dialog-title>Login to Inkweld</h2>
  </div>

  <mat-dialog-content>
    <form (ngSubmit)="onLogin()" data-testid="login-form">
      <mat-form-field appearance="outline">
        <mat-label>Username</mat-label>
        <input
          matInput
          type="text"
          [(ngModel)]="username"
          (ngModelChange)="onUsernameChange()"
          name="username"
          required
          data-testid="username-input"
          aria-label="Username" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Password</mat-label>
        <input
          matInput
          type="password"
          [(ngModel)]="password"
          (ngModelChange)="onPasswordChange()"
          name="password"
          required
          data-testid="password-input"
          aria-label="Password" />
      </mat-form-field>

      <!-- Custom error message with icon -->
      @if (passwordError()) {
        <div class="password-error-message" data-testid="password-error">
          <mat-icon class="error-icon">error_outline</mat-icon>
          <span>{{ passwordError() }}</span>
        </div>
      }

      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="isLoginButtonDisabled()"
        data-testid="login-button"
        class="login-button">
        @if (!isLoggingIn()) {
          <span>Login</span>
        }
        @if (isLoggingIn()) {
          <span>Logging in...</span>
        }
      </button>

      @if (isEmailEnabled()) {
        <a
          class="forgot-password-link"
          tabindex="0"
          role="link"
          (click)="goToForgotPassword()"
          (keydown.enter)="goToForgotPassword()"
          data-testid="forgot-password-link">
          Forgot password?
        </a>
      }
    </form>

    <mat-divider></mat-divider>

    <div class="oauth-container">
      <app-oauth-provider-list
        [isRegisterContext]="false"
        (loaded)="onProvidersLoaded()"></app-oauth-provider-list>
    </div>

    <button
      mat-raised-button
      color="primary"
      type="button"
      (click)="onRegisterClick()"
      data-testid="register-link"
      class="register-button">
      Don't have an account? Register here
    </button>
  </mat-dialog-content>
</div>
