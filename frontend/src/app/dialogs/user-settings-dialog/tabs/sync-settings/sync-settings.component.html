<div class="sync-settings">
  <h3>Synchronization Settings</h3>

  @if (currentMode === 'offline') {
    <mat-card class="info-card offline">
      <mat-card-content>
        <div class="info-content">
          <mat-icon>info</mat-icon>
          <div>
            <strong>Offline Mode:</strong> Synchronization is not available in
            offline mode. Switch to server mode in the Connection tab to enable
            sync features.
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  }

  @if (currentMode === 'server') {
    <!-- Sync Status Card -->
    <mat-card class="status-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>sync</mat-icon>
          Sync Status
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="status-grid">
          <div class="status-item">
            <span class="label">Last Sync:</span>
            <span class="value">{{ getLastSyncTime() }}</span>
          </div>
          <div class="status-item">
            <span class="label">Pending Changes:</span>
            <span class="value">{{ syncStatus().pendingChanges }}</span>
          </div>
          <div class="status-item">
            <span class="label">Status:</span>
            <span
              class="value"
              [class.syncing]="syncStatus().isSyncing"
              [class.idle]="!syncStatus().isSyncing">
              @if (syncStatus().isSyncing) {
                <mat-icon class="spin">sync</mat-icon>
                Syncing...
              }
              @if (!syncStatus().isSyncing) {
                <mat-icon>check_circle</mat-icon>
                Up to date
              }
            </span>
          </div>
        </div>

        @if (syncStatus().isSyncing) {
          <mat-progress-bar mode="indeterminate"></mat-progress-bar>
        }

        <div class="action-buttons">
          <button
            mat-raised-button
            color="primary"
            (click)="triggerManualSync()"
            [disabled]="syncStatus().isSyncing">
            <mat-icon>sync</mat-icon>
            Sync Now
          </button>

          @if (syncStatus().pendingChanges > 0) {
            <button
              mat-stroked-button
              color="warn"
              (click)="resolveConflicts()"
              [disabled]="syncStatus().isSyncing">
              <mat-icon>merge</mat-icon>
              Resolve Conflicts
            </button>
          }
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Auto-Sync Settings Card -->
    <mat-card class="settings-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>settings</mat-icon>
          Auto-Sync Settings
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="setting-item">
          <div class="setting-info">
            <strong>Automatic Synchronization</strong>
            <p>
              Automatically sync your changes with the server in the background
            </p>
          </div>
          <mat-slide-toggle
            [checked]="autoSyncEnabled()"
            (change)="toggleAutoSync()"
            color="primary">
          </mat-slide-toggle>
        </div>

        @if (autoSyncEnabled()) {
          <div class="setting-item">
            <div class="setting-info">
              <strong>Sync Interval</strong>
              <p>How often to automatically sync (in minutes)</p>
            </div>
            <div class="interval-buttons">
              @for (interval of [1, 5, 15, 30]; track interval) {
                <button
                  mat-stroked-button
                  [color]="syncInterval() === interval ? 'primary' : ''"
                  (click)="updateSyncInterval(interval)">
                  {{ interval }}m
                </button>
              }
            </div>
          </div>
        }
      </mat-card-content>
    </mat-card>

    <!-- Sync Info Card -->
    <mat-card class="info-card">
      <mat-card-content>
        <div class="info-content">
          <mat-icon>info</mat-icon>
          <div>
            <strong>About Synchronization:</strong>
            <ul>
              <li>
                Your work is automatically saved locally and synced with the
                server
              </li>
              <li>
                Changes are merged intelligently using conflict resolution
              </li>
              <li>You can work offline and sync when you're back online</li>
              <li>
                Manual sync allows you to force an immediate synchronization
              </li>
            </ul>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  }
</div>
